<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>1.6 Using the Jupyter notebook - Coding for Data - 2019 edition</title>
<meta name="description" content="Using Jupyter notebooks">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_UK">
<meta property="og:site_name" content="Coding for Data - 2019 edition">
<meta property="og:title" content="1.6 Using the Jupyter notebook">
<meta property="og:url" content="https://matthew-brett.github.io/cfd2019/chapters/01/using_jupyter">


  <meta property="og:description" content="Using Jupyter notebooks">







  <meta property="article:published_time" content="2019-10-08T16:25:19+01:00">





  

  


<link rel="canonical" href="https://matthew-brett.github.io/cfd2019/chapters/01/using_jupyter">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Matthew Brett",
      "url": "https://matthew-brett.github.io/cfd2019",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/cfd2019/feed.xml" type="application/atom+xml" rel="alternate" title="Coding for Data - 2019 edition Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/cfd2019/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->


<!-- end custom head snippets -->

    <link rel="stylesheet" href="/cfd2019/assets/css/notebook-markdown.css">
    <link rel="stylesheet" href="/cfd2019/assets/css/custom.css">
    <link rel="shortcut icon" type="image/png" href="/cfd2019/favicon.png">
    <script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js"></script>
  </head>

  <body class="layout--textbook">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

    <div class="initial-content">
      



<div id="main" class="textbook" role="main">
  <div id="textbook_wrapper">
    
  <div class="sidebar sticky textbook">
  
  
    <img src="/cfd2019/images/dsfe_logo.png" class="textbook_logo" />
    

    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

          <a href="/cfd2019/"><span class="nav__sub-title">Home</span></a>
        

        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/01/intro"><span class="nav__sub-title">1. Coding for data</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/what-is-data-science" class="level_1">1.1 What is data science?</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/why-data-science" class="level_1">1.2 Why data science?</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/tools_techniques" class="level_1">1.3 Tools and techniques</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/computational-tools" class="level_2">1.3.1 Computational tools</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/statistical-techniques" class="level_2">1.3.2 Statistical techniques</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/Plotting_the_Classics" class="level_1">1.4 Plotting the classics</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/Literary_Characters" class="level_2">1.4.1 Literary characters</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/Another_Kind_Of_Character" class="level_2">1.4.2 Another kind of character</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/surviving_computers" class="level_1">1.5 Surviving the computer</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/01/using_jupyter" class="level_1">1.6 Using the Jupyter notebook</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/02/to_code"><span class="nav__sub-title">2. Programming</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/sampling_problem" class="level_1">2.1 A sampling problem</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/three_girls" class="level_1">2.4 A simpler problem</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/variables_intro" class="level_1">2.2 Introduction to variables</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/functions" class="level_1">2.3 Introduction to functions</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/Expressions" class="level_1">2.5 Expressions</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/variables" class="level_1">2.6 More on variables</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/Names" class="level_1">2.7 Names</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/02/Calls" class="level_1">2.8 Call expressions</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/03/data_types"><span class="nav__sub-title">3. Data types</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/Numbers" class="level_1">3.1 Numbers</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/Strings" class="level_1">3.2 Strings</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/Comparison" class="level_1">3.3 Comparison</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/Arrays" class="level_1">3.4 Arrays</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/Ranges" class="level_1">3.5 Ranges</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/More_on_Arrays" class="level_1">3.6 More on arrays</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/arrays_and_axes" class="level_1">3.7 Arrays and axes</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/reply_supreme" class="level_1">3.8 Reply to the Supreme Court</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/three_girls" class="level_1">3.9 Revision - three girls</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/03/array_indexing" class="level_1">3.10 Selecting with arrays</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/04/data_frames"><span class="nav__sub-title">4. Data frames</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/04/data_frame_intro" class="level_1">4.1 Introduction to data frames</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/05/permutation"><span class="nav__sub-title">5. Permutations</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/05/population_permutation" class="level_1">5.1 Population and permutation</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/05/lists" class="level_1">5.2 lists</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/05/iteration" class="level_1">5.3 Iteration with For loops</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/05/indentation" class="level_1">5.4 Indentation, indentation</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/05/ones_zeros" class="level_1">5.5 Ones and zeros</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/05/brexit_ages" class="level_1">5.6 A permutation test</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/06/more_simulation"><span class="nav__sub-title">6. More on simulation</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/06/sorting_arrays" class="level_1">6.1 Sorting arrays</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/06/monty_hall" class="level_1">6.2 Monty hall problem</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/07/more_building_blocks"><span class="nav__sub-title">7. More building blocks</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/07/none" class="level_1">7.2 None</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/07/functions" class="level_1">7.1 Functions</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/07/functions_as_values" class="level_1">7.1 Functions as values</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/07/conditional_statements" class="level_1">7.2 Conditional statements</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/08/mean"><span class="nav__sub-title">8. The mean and straight line relationships</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/08/mean_meaning" class="level_1">8.1 The mean as a predictor</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/08/where_and_argmin" class="level_1">8.2 Where and argmin</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/08/mean_and_slopes" class="level_1">8.3 Mean and slopes</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/08/optimization" class="level_1">8.4 Optimization</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/08/finding_lines" class="level_1">8.5 Finding lines</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/08/inference_on_slopes" class="level_1">8.6 Believable slopes</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/09/classification"><span class="nav__sub-title">9. Classification</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/09/standard_scores" class="level_1">9.1 Standard scores</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/09/Nearest_Neighbors" class="level_1">9.2 Nearest neighbors</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/09/Training_and_Testing" class="level_1">9.3 Training and testing</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/09/Rows_of_Tables" class="level_1">9.4 Rows of tables</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/09/Implementing_the_Classifier" class="level_1">9.5 Implementing the classifier</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/09/Accuracy_of_the_Classifier" class="level_1">9.6 Accuracy of the classifier</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/10/end_of_beginning"><span class="nav__sub-title">10. The end of the beginning</span></a>
        

        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/exercises/exercises"><span class="nav__sub-title">Exercises</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/interesting" class="level_1">Interesting, no?</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/exercises/names" class="level_1">Thinking about names</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/three_girl_simulations" class="level_1">Three girl simulations</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/array_indexing" class="level_1">Array indexing</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/simulation" class="level_1">More simulations</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/df_exercises" class="level_1">Data frames</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/brexit_analysis" class="level_1">Brexit analysis</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/for_loops" class="level_1">For loops</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/money_and_death" class="level_1">Money and death</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/function_exercises" class="level_1">Function exercises</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/functions_values_exercises" class="level_1">Function as values exercises</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/exercises/conditional_statements_exercises" class="level_1">Conditional statement exercises</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/cfd2019/chapters/extra/extra"><span class="nav__sub-title">Extra pages</span></a>
        

        
        <ul>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/extra/more_on_lists" class="level_1">More on lists</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/extra/monty_hall_lists" class="level_1">Monty Hall with lists</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/extra/data8_functions" class="level_1">Berkeley introduction to functions</a></li>
          
            
            

            
            

            

            <li><a href="/cfd2019/chapters/extra/mean_deviations" class="level_1">Deviations around the mean</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    

  
  </div>


    <article class="page textbook" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="headline" content="1.6 Using the Jupyter notebook">
      <meta itemprop="description" content="Using Jupyter notebooks">
      <meta itemprop="datePublished" content="October 08, 2019">
      

      <div class="page__inner-wrap">
        
          <header>
            <h1 id="page-title" class="page__title" itemprop="headline">1.6 Using the Jupyter notebook
</h1>
          </header>
        

        <section class="page__content" itemprop="text">
          
            

<!-- TOC will only show up if it has at least one item -->



          
          <!-- INTERACT LINKS -->

    
    
    <a class="notebook-link" href="https://matthew-brett.github.io/cfd2019/notebooks/01/using_jupyter.ipynb">Download notebook</a>
    <a class="interact-button" href="https://mybinder.org/v2/gh/matthew-brett/cfd2019/master?filepath=notebooks%2F01%2Fusing_jupyter.ipynb">Interact</a>


          <h1 id="using-jupyter-notebooks">Using Jupyter notebooks</h1>

<p>This is a cell.</p>

<p>It’s a cell with text - a text cell.</p>

<p>A text cell can have formatting, such as links.</p>

<p>For example, see <a href="https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Notebook%20Basics.html">Notebook basics</a> for another introduction to the notebook interface.</p>

<p>See that page for an introduction to the notebook Dashboard, where you can open notebooks from a file listing, or create new ones.</p>

<p>If you are in the classic Jupyter Notebook interface (rather than reading this in the textbook), you will see the Jupyter Menu near the top of the page, with headings “File”, “Edit” and so on.</p>

<p>Underneath that, by default, you may see a row of icons - the “Toolbar”.</p>

<p>In the toolbar, you may see icons to run the current cell, among others.</p>

<p>Here’s a picture, for those of you reading this in textbook form.</p>

<p><img src="https://jupyter-notebook.readthedocs.io/en/stable/_images/menubar_toolbar.png" alt="" /></p>

<p>To move from one cell to the next, you can click the run icon in the toolbar, but it is more efficient to press the Shift key, and press Enter (with Shift still held down).  We will write this as Shift-Enter.</p>

<p>This is another text cell.</p>

<p>The next cell is a code cell.</p>

<p>The code cell is for Python code (actually, you can type code in other languages too, but we won’t be using that feature).</p>

<p>Here we will be using Python like a calculator.</p>

<p>Our problem is the following:</p>

<p>Alex and Billie are at a restaurant, getting ready to order. They don’t have much money, so they are calculating their expected bill before they order.</p>

<p>Alex is thinking of having the fish for £10.50, and Billie is leaning towards the chicken, at £9.25.  First they calculate their combined bill.</p>

<p>Press Shift-Enter in the cell below, to see the total:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">10.50</span> <span class="o">+</span> <span class="mf">9.25</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>19.75
</code></pre></div></div>

<p>The cell above is Python code.  As you would predict, Python understands numbers like <code class="highlighter-rouge">10.50</code>, and it understands <code class="highlighter-rouge">+</code> between the numbers as an instruction to add the numbers.</p>

<p>When you press Shift-Enter, Python makes its own representation of <code class="highlighter-rouge">10.50</code>, and its own representation of <code class="highlighter-rouge">9.25</code>, and then runs the <em>addition</em> operation on these two, which results in Python’s representation of <code class="highlighter-rouge">19.75</code>.</p>

<p>Finally, Python sends back the <code class="highlighter-rouge">19.75</code>.  The notebook detects that Python sent back a value, and shows it to us.</p>

<p>This is exactly what a calculator would do.</p>

<p>Unlike a calculator, we can also put notes next to our calculations, to remind us what they are for.   One way of doing this is to use a “comment”.</p>

<p>A comment is some text that the computer will ignore.  In Python, you can make a comment by starting a line with the <code class="highlighter-rouge">#</code> (hash) character.  For example, the next cell is a code cell, but when you run it, it does not show any result.  In this case, that is because the computer sees the <code class="highlighter-rouge">#</code> at the beginning of the line, and then ignores the rest.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This bit of text is for me to read, and the computer to ignore.
</span></code></pre></div></div>

<p>Many of the code cells you see will have comments in them, to explain what the code is doing.</p>

<p>Practice writing comments for your own code.  It is a very good habit to get into.  You will find that experienced programmers write many comments on their code.</p>

<p>Let’s continue with Alex and Billie’s struggle with their bill.</p>

<p>They realize that they will also need to pay a tip.</p>

<p>They think a 15% tip is reasonable.  Now they need to multiply their total bill by 0.15, to get the tip.  Given the bill is about £20, the tip will be about £3.</p>

<p>In Python, as for your calculator, <code class="highlighter-rouge">*</code> means multiplication.</p>

<p>What about this?</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The bill plus tip - with a mistake.
</span><span class="mf">10.50</span> <span class="o">+</span> <span class="mf">9.25</span> <span class="o">*</span> <span class="mf">0.15</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>11.8875
</code></pre></div></div>

<p>Oops, that isn’t doing the right calculation.</p>

<p>Python follows the normal rules of multiplication before addition.</p>

<p>See <a href="https://en.wikipedia.org/wiki/Order_of_operations">https://en.wikipedia.org/wiki/Order_of_operations</a>.</p>

<p>In the case above, that means Python first calculates <code class="highlighter-rouge">9.25 * 0.15</code> (to get <code class="highlighter-rouge">1.3875</code>) and then adds the result to <code class="highlighter-rouge">10.50</code>, to get <code class="highlighter-rouge">11.8875</code>.</p>

<p>We need to tell Python to do the addition and then the multiplication.  We do this with round brackets (parentheses):</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The bill plus tip - mistake fixed.
</span><span class="p">(</span><span class="mf">10.50</span> <span class="o">+</span> <span class="mf">9.25</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span>
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.9625
</code></pre></div></div>

<p>Now your turn.  Calculate Alex and Billie’s bill including the tip:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The bill, including the tip
# Type your code below.
</span></code></pre></div></div>

<p>Alex and Billie are each going to pay half the bill.   Calculate half the bill (where the bill is the total bill including the tip):</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Half the total bill, including the tip
# Type your code below.
</span></code></pre></div></div>

<p>Alex is planning to drink three cherry colas, each at £1.50.   Billie is going to have a glass of wine, at £3.50.  Now what is their combined bill, plus tip?</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The total bill, including drinks, and the tip.
# Type your code below.
</span></code></pre></div></div>


          
        </section>

        <footer class="page__meta">
          
          


        </footer>

        

        
  <nav class="pagination">
    
      <a href="/cfd2019/chapters/01/surviving_computers" class="pagination--pager" title="1.5 Surviving the computer
">Previous</a>
    
    
      <a href="/cfd2019/chapters/02/to_code" class="pagination--pager" title="
  Programming

">Next</a>
    
  </nav>


      </div>

      
    </article>
  </div>
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>
      </div>
    

    

    
  <script src="/cfd2019/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>




<script src="/cfd2019/assets/js/lunr/lunr.min.js"></script>
<script src="/cfd2019/assets/js/lunr/lunr-store.js"></script>
<script src="/cfd2019/assets/js/lunr/lunr-en.js"></script>




    <!-- Custom scripts to load after site JS is loaded -->

    <!-- Custom HTML used for the textbooks -->
<!-- Configure, then load MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      processEnvironments: true
    }
  };
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full,Safe" type="text/javascript"></script>


<script type="text/javascript">
// --- To auto-embed hub URLs in interact links if given in a RESTful fashion ---
function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return jQuery.param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = $("a").each(function() {
    var href = this.href;
    // If the link is an internal link...
    if (href.search("https://matthew-brett.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + jQuery.param(params);
      this.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

  // Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = $("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          if ('binder' == 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("https://mybinder.org", hubUrl);
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          $("a.interact-button").after($('<div class="interact-context">on ' + hubUrlNoHttp + '</div>'));

      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

// --- Highlight the part of sidebar for current page ---

// helper to replace trailing slash
function replaceSlash(string)
{
    return string.replace(/\/$/, "");
}

// Add a class to the current page in the sidebar
function highlightSidebarCurrentPage()
{
  var currentpage = location.href;
  var links = $('.sidebar .nav__items a');
  var ii = 0;
  for(ii; ii < links.length; ii++) {
    var link = links[ii];
    if(replaceSlash(link.href) == replaceSlash(currentpage)) {
      // Add CSS for styling
      link.classList.add("current");
      // Scroll to this element
      $('div.sidebar').scrollTop(link.offsetTop - 300);
    }
  }
}

// --- Set up copy/paste for code blocks ---
function addCopyButtonToCode(){
  // get all <code> elements
  var allCodeBlocksElements = $( "div.input_area code, div.highlighter-rouge code" );

  allCodeBlocksElements.each(function(ii) {
   	// add different id for each code block

  	// target
    var currentId = "codeblock" + (ii + 1);
    $(this).attr('id', currentId);

    //trigger
    var clipButton = '<button class="btn copybtn" data-clipboard-target="#' + currentId + '"><img src="https://clipboardjs.com/assets/images/clippy.svg" width="13" alt="Copy to clipboard"></button>';
       $(this).after(clipButton);
    });

    new Clipboard('.btn');
}

// Run scripts when page is loaded
$(document).ready(function () {
  // Add anchors to H1 etc links
  anchors.add();
  // Highlight current page in sidebar
  highlightSidebarCurrentPage();
  // Add copy button to code blocks
  addCopyButtonToCode();
  // Update the Interact link if a REST param given
  updateInteractLink();
});
</script>

  </body>
</html>
